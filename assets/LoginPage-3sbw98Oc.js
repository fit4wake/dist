import{a7 as e,r as t,j as a,aF as i,N as s,b as n,y as r,B as o,o as c,Z as l}from"./vendor-VHbKv6Ho.js";import{b as m,u as h,a as x,bd as d,be as g}from"./main-d-KpagPl.js";import{T as u,G as j}from"./GoogleButton-gRPWX8NF.js";import"./index-ByFO5s06.js";const f=()=>{const{t:f}=m(),{authenticateWithTelegramWebApp:p,authenticateWithTelegramWidget:y,authenticateWithGoogleOAuth:b,isAuthenticated:A,isLoading:v,error:w,telegramWebApp:I}=h(),W=e(),{showToast:T,showErrorToast:E}=x(),[z,B]=t.useState(!1);t.useEffect((()=>{p().catch((()=>{}))}),[p]),t.useEffect((()=>{if(A){const e=localStorage.getItem("redirectAfterLogin");e?(setTimeout((()=>{localStorage.removeItem("redirectAfterLogin")}),1e4),W(e,{replace:!0})):W("/",{replace:!0})}}),[A]);return v?a.jsxs(i,{maxWidth:"sm",sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"100vh",textAlign:"center"},children:[a.jsx(s,{sx:{mb:2}}),a.jsx(n,{variant:"h6",children:f("auth.authorization")})]}):a.jsx(i,{maxWidth:"sm",sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsxs(r,{sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center",width:"100%"},children:[a.jsx(o,{component:"img",src:"/teachair-logo.svg",alt:"Teachair",sx:{width:128,height:128,marginBottom:2}}),a.jsx(n,{sx:{marginBottom:4},children:f("auth.welcome")}),v&&a.jsxs(a.Fragment,{children:[a.jsx(s,{}),a.jsx(n,{variant:"body2",sx:{my:2},children:f("auth.authorization")})]}),!v&&!I&&a.jsx(a.Fragment,{children:a.jsx(c,{variant:"contained",color:"primary",onClick:()=>{window.location.reload()},children:f("common.actions.tryAgain")})}),!v&&I&&a.jsxs(o,{sx:{display:"flex",alignItems:"center",flexDirection:"column",gap:2},children:[a.jsx(u,{botName:"teachair_bot",onAuth:e=>{y(e)},size:"large",requestAccess:"read"}),a.jsx(c,{variant:"text",size:"small",onClick:()=>B(!z),endIcon:z?a.jsx(d,{}):a.jsx(g,{}),sx:{mt:1},children:f(z?"auth.hideAlternative":"auth.showAlternative")}),a.jsx(l,{in:z,timeout:"auto",unmountOnExit:!0,children:a.jsxs(o,{sx:{display:"flex",alignItems:"center",flexDirection:"column",gap:0,width:"100%"},children:[a.jsx(n,{variant:"body2",sx:{mb:3,color:"text.secondary"},children:f("auth.telegramRecommendation")}),a.jsx(j,{onSuccess:e=>{b(e)},onError:e=>{E(e)}})]})})]})]})})};export{f as default};
