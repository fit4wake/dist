import{p as e}from"./chunk-4BMEZGHF-B3CA2XGZ.js";import{a$ as t,b1 as a,b0 as i,b2 as n,b3 as s,bk as r,bj as l,b6 as o,b4 as p,bv as c,bz as d,bB as g,bC as m,bD as u,b7 as h,bp as b,bE as f,bx as x}from"./main-CRu-gqtW.js";import{p as S}from"./radar-MK3ICKWK-DGLGkpBS.js";import"./vendor-5I4LDDhx.js";import"./_baseUniq-CS9fSEi3.js";import"./_basePickBy-CICrgrpV.js";import"./clone-5WG2d0Wf.js";var w=x.pie,y={sections:new Map,showData:!1},$=y.sections,C=y.showData,D=structuredClone(w),T={getConfig:t((()=>structuredClone(D)),"getConfig"),clear:t((()=>{$=new Map,C=y.showData,b()}),"clear"),setDiagramTitle:l,getDiagramTitle:r,setAccTitle:s,getAccTitle:n,setAccDescription:i,getAccDescription:a,addSection:t((({label:e,value:t})=>{$.has(e)||($.set(e,t),o.debug(`added new section: ${e}, with value: ${t}`))}),"addSection"),getSections:t((()=>$),"getSections"),setShowData:t((e=>{C=e}),"setShowData"),getShowData:t((()=>C),"getShowData")},v=t(((t,a)=>{e(t,a),a.setShowData(t.showData),t.sections.map(a.addSection)}),"populateDb"),k={parse:t((async e=>{const t=await S("pie",e);o.debug(t),v(t,T)}),"parse")},A=t((e=>`\n  .pieCircle{\n    stroke: ${e.pieStrokeColor};\n    stroke-width : ${e.pieStrokeWidth};\n    opacity : ${e.pieOpacity};\n  }\n  .pieOuterCircle{\n    stroke: ${e.pieOuterStrokeColor};\n    stroke-width: ${e.pieOuterStrokeWidth};\n    fill: none;\n  }\n  .pieTitleText {\n    text-anchor: middle;\n    font-size: ${e.pieTitleTextSize};\n    fill: ${e.pieTitleTextColor};\n    font-family: ${e.fontFamily};\n  }\n  .slice {\n    font-family: ${e.fontFamily};\n    fill: ${e.pieSectionTextColor};\n    font-size:${e.pieSectionTextSize};\n    // fill: white;\n  }\n  .legend text {\n    fill: ${e.pieLegendTextColor};\n    font-family: ${e.fontFamily};\n    font-size: ${e.pieLegendTextSize};\n  }\n`),"getStyles"),j=t((e=>{const t=[...e.entries()].map((e=>({label:e[0],value:e[1]}))).sort(((e,t)=>t.value-e.value));return f().value((e=>e.value))(t)}),"createPieArcs"),z={parser:k,db:T,renderer:{draw:t(((e,t,a,i)=>{o.debug("rendering pie chart\n"+e);const n=i.db,s=p(),r=c(n.getConfig(),s.pie),l=18,b=450,f=b,x=d(t),S=x.append("g");S.attr("transform","translate(225,225)");const{themeVariables:w}=s;let[y]=g(w.pieOuterStrokeWidth);y??(y=2);const $=r.textPosition,C=Math.min(f,b)/2-40,D=m().innerRadius(0).outerRadius(C),T=m().innerRadius(C*$).outerRadius(C*$);S.append("circle").attr("cx",0).attr("cy",0).attr("r",C+y/2).attr("class","pieOuterCircle");const v=n.getSections(),k=j(v),A=[w.pie1,w.pie2,w.pie3,w.pie4,w.pie5,w.pie6,w.pie7,w.pie8,w.pie9,w.pie10,w.pie11,w.pie12],z=u(A);S.selectAll("mySlices").data(k).enter().append("path").attr("d",D).attr("fill",(e=>z(e.data.label))).attr("class","pieCircle");let M=0;v.forEach((e=>{M+=e})),S.selectAll("mySlices").data(k).enter().append("text").text((e=>(e.data.value/M*100).toFixed(0)+"%")).attr("transform",(e=>"translate("+T.centroid(e)+")")).style("text-anchor","middle").attr("class","slice"),S.append("text").text(n.getDiagramTitle()).attr("x",0).attr("y",-200).attr("class","pieTitleText");const O=S.selectAll(".legend").data(z.domain()).enter().append("g").attr("class","legend").attr("transform",((e,t)=>"translate(216,"+(22*t-22*z.domain().length/2)+")"));O.append("rect").attr("width",l).attr("height",l).style("fill",z).style("stroke",z),O.data(k).append("text").attr("x",22).attr("y",14).text((e=>{const{label:t,value:a}=e.data;return n.getShowData()?`${t} [${a}]`:t}));const B=512+Math.max(...O.selectAll("text").nodes().map((e=>(null==e?void 0:e.getBoundingClientRect().width)??0)));x.attr("viewBox",`0 0 ${B} 450`),h(x,b,B,r.useMaxWidth)}),"draw")},styles:A};export{z as diagram};
