import{p as e}from"./chunk-4BMEZGHF-pzSgVm6t.js";import{ba as t,bc as a,bb as i,bd as n,be as s,bv as r,bu as l,bh as o,bf as p,bG as c,bK as d,bM as g,bN as m,bO as u,bi as h,bA as b,bP as f,bI as x}from"./main-mWCWJs1P.js";import{p as S}from"./radar-MK3ICKWK-QZdyjh3R.js";import"./vendor-VLBVWaDG.js";import"./_baseUniq-rMbFdfPL.js";import"./_basePickBy-BoNtNF9h.js";import"./clone-DWCTqVc5.js";var w=x.pie,y={sections:new Map,showData:!1},$=y.sections,T=y.showData,C=structuredClone(w),D={getConfig:t((()=>structuredClone(C)),"getConfig"),clear:t((()=>{$=new Map,T=y.showData,b()}),"clear"),setDiagramTitle:l,getDiagramTitle:r,setAccTitle:s,getAccTitle:n,setAccDescription:i,getAccDescription:a,addSection:t((({label:e,value:t})=>{$.has(e)||($.set(e,t),o.debug(`added new section: ${e}, with value: ${t}`))}),"addSection"),getSections:t((()=>$),"getSections"),setShowData:t((e=>{T=e}),"setShowData"),getShowData:t((()=>T),"getShowData")},v=t(((t,a)=>{e(t,a),a.setShowData(t.showData),t.sections.map(a.addSection)}),"populateDb"),k={parse:t((async e=>{const t=await S("pie",e);o.debug(t),v(t,D)}),"parse")},A=t((e=>`\n  .pieCircle{\n    stroke: ${e.pieStrokeColor};\n    stroke-width : ${e.pieStrokeWidth};\n    opacity : ${e.pieOpacity};\n  }\n  .pieOuterCircle{\n    stroke: ${e.pieOuterStrokeColor};\n    stroke-width: ${e.pieOuterStrokeWidth};\n    fill: none;\n  }\n  .pieTitleText {\n    text-anchor: middle;\n    font-size: ${e.pieTitleTextSize};\n    fill: ${e.pieTitleTextColor};\n    font-family: ${e.fontFamily};\n  }\n  .slice {\n    font-family: ${e.fontFamily};\n    fill: ${e.pieSectionTextColor};\n    font-size:${e.pieSectionTextSize};\n    // fill: white;\n  }\n  .legend text {\n    fill: ${e.pieLegendTextColor};\n    font-family: ${e.fontFamily};\n    font-size: ${e.pieLegendTextSize};\n  }\n`),"getStyles"),M=t((e=>{const t=[...e.entries()].map((e=>({label:e[0],value:e[1]}))).sort(((e,t)=>t.value-e.value));return f().value((e=>e.value))(t)}),"createPieArcs"),j={parser:k,db:D,renderer:{draw:t(((e,t,a,i)=>{o.debug("rendering pie chart\n"+e);const n=i.db,s=p(),r=c(n.getConfig(),s.pie),l=18,b=450,f=b,x=d(t),S=x.append("g");S.attr("transform","translate(225,225)");const{themeVariables:w}=s;let[y]=g(w.pieOuterStrokeWidth);y??(y=2);const $=r.textPosition,T=Math.min(f,b)/2-40,C=m().innerRadius(0).outerRadius(T),D=m().innerRadius(T*$).outerRadius(T*$);S.append("circle").attr("cx",0).attr("cy",0).attr("r",T+y/2).attr("class","pieOuterCircle");const v=n.getSections(),k=M(v),A=[w.pie1,w.pie2,w.pie3,w.pie4,w.pie5,w.pie6,w.pie7,w.pie8,w.pie9,w.pie10,w.pie11,w.pie12],j=u(A);S.selectAll("mySlices").data(k).enter().append("path").attr("d",C).attr("fill",(e=>j(e.data.label))).attr("class","pieCircle");let O=0;v.forEach((e=>{O+=e})),S.selectAll("mySlices").data(k).enter().append("text").text((e=>(e.data.value/O*100).toFixed(0)+"%")).attr("transform",(e=>"translate("+D.centroid(e)+")")).style("text-anchor","middle").attr("class","slice"),S.append("text").text(n.getDiagramTitle()).attr("x",0).attr("y",-200).attr("class","pieTitleText");const z=S.selectAll(".legend").data(j.domain()).enter().append("g").attr("class","legend").attr("transform",((e,t)=>"translate(216,"+(22*t-22*j.domain().length/2)+")"));z.append("rect").attr("width",l).attr("height",l).style("fill",j).style("stroke",j),z.data(k).append("text").attr("x",22).attr("y",14).text((e=>{const{label:t,value:a}=e.data;return n.getShowData()?`${t} [${a}]`:t}));const F=512+Math.max(...z.selectAll("text").nodes().map((e=>(null==e?void 0:e.getBoundingClientRect().width)??0)));x.attr("viewBox",`0 0 ${F} 450`),h(x,b,F,r.useMaxWidth)}),"draw")},styles:A};export{j as diagram};
